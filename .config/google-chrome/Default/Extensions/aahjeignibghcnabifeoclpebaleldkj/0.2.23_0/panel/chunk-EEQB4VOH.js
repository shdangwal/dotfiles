var g=class{constructor(r,e,n,s="",t=""){this.id="r"+Math.random().toString(36).slice(2),this.name=s,this.ctmGroupTitle=t,this.color=n??"grey",this.urlMatches=r??{},this.titleIncludes=e??[],this.priority=0,this.enabled=!0,this.createdAt=Date.now(),this.lastModifiedAt=Date.now()}};var a={TabGroupRules:"TabGroupRules"};function b({target:o}){o.result.createObjectStore(a.TabGroupRules,{keyPath:"id"})}function c(){return new Promise((o,r)=>{let e=indexedDB.open("tabVertikal",1);e.onupgradeneeded=b,e.onsuccess=()=>o(e.result),e.onerror=()=>r(e.error),e.onblocked=()=>console.warn("Pending until unblocked")})}async function x(){return new Promise((o,r)=>{c().then(e=>{let s=e.transaction(a.TabGroupRules,"readonly").objectStore(a.TabGroupRules).getAll();s.onsuccess=({target:t})=>o(t.result),s.onerror=t=>r(t),e.close()})})}async function R(){return new Promise((o,r)=>{c().then(e=>{let s=e.transaction(a.TabGroupRules,"readonly").objectStore(a.TabGroupRules).count();s.onsuccess=({target:t})=>o(t.result>=1),s.onerror=t=>r(t),e.close()})})}async function _(o){return new Promise((r,e)=>{c().then(n=>{let t=n.transaction(a.TabGroupRules,"readwrite").objectStore(a.TabGroupRules).put(o);t.onsuccess=i=>{chrome.runtime.sendMessage("reset_tab_group_rules"),r(o)},t.onerror=i=>e(i),n.close()})})}async function A(o,r,e){return new Promise((n,s)=>{c().then(t=>{let i=t.transaction(a.TabGroupRules,"readwrite").objectStore(a.TabGroupRules),m=i.get(o);m.onsuccess=({target:u})=>{let l=u.result;l[r]=e,l.lastModifiedAt=Date.now();let d=i.put(l);d.onsuccess=p=>{chrome.runtime.sendMessage("reset_tab_group_rules"),n(p.target.result)},d.onerror=p=>s(p)},m.onerror=u=>s(u),t.close()})})}async function k(o){return new Promise((r,e)=>{c().then(n=>{let t=n.transaction(a.TabGroupRules,"readwrite").objectStore(a.TabGroupRules).delete(o);t.onsuccess=i=>{chrome.runtime.sendMessage("reset_tab_group_rules"),r(i.target.result)},t.onerror=i=>e(i),n.close()})})}var h=class extends HTMLDialogElement{constructor(r){super(),this.error=r,this.gmailUrl="https://mail.google.com/mail/u/0/",this.mailTo="noterailhelp@gmail.com"}async reportBug(){let{version:r,short_name:e}=chrome.runtime.getManifest(),n=this.error.stack?.replaceAll(`
`,"%0A"),s=`${this.gmailUrl}?to=${this.mailTo}&su=${this.error.message}&body=Error:%20${this.error.message}%0AStack:%20${n}%0AExtensionId:%20${chrome.runtime.id}%0AExtension%20Name:%20${e}%0AExtension%20Version:%20${r}%0ABrowser%20Info:%20${navigator.userAgent}&fs=1&tf=cm`;await chrome.tabs.create({url:s})}render(){return`<h2>\u{1F62A} ${chrome.i18n.getMessage("sorry_something_went_wrong")} \u{1F41B}</h2>
			<p style="max-width: 50ch;overflow-wrap: break-word;">\u274C ${this.error.message?.replaceAll("<","&lt;")?.replaceAll(">","&gt;")}</p>
			<button style="font-size: 1rem;margin-inline: auto;display: block;"> 
				\u{1F41E} <span>${chrome.i18n.getMessage("report_bug")}</span>
			</button>
			<div style="text-align:center;font-size:x-small;">${chrome.i18n.getMessage("just_one_click")}</div>`}connectedCallback(){this.id="report-bug",this.innerHTML=this.render(),this.showModal(),this.lastElementChild.previousElementSibling.addEventListener("click",this.reportBug.bind(this))}};customElements.define("report-bug",h,{extends:"dialog"});export{g as a,x as b,R as c,_ as d,A as e,k as f,h as g};
